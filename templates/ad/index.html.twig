{% extends 'base.html.twig' %}

{% block title %}Animals!
{% endblock %}

{% block body %}
	<div class="ui container">
		<a class="ui primary right floated button" href="{{ path('add_ad') }}">Add an Ad</a>
		<form action="{{ path('filter_by_category') }}" method="post">
			<select name="category" class="ui dropdown right floated segment" id="category" onchange="this.form.submit()">
				<option value="">Select category</option>
				{% for category in categories %}
					{% if selectedCategory is defined and selectedCategory == category %}
						<option value={{ category.id }} selected>{{ category.name}}</option>
					{% else %}
						<option value={{ category.id }}>{{ category.name}}</option>
					{% endif %}
				{% endfor %}
			</select>
		</form>
	</div>
	<div class="ui main text container">
		<div class="ui relaxed divided list">
			{% for ad in pagination %}
				{% if ad.ad is defined %}
					{% if ad.ad.boost is not null and ad.ad.boost.dateFrom|date('Y-m-d') <= "now"|date('Y-m-d') %}
						<div class="item boosted">
						{% else %}
							<div class="item">
							{% endif %}
							<div class="content">
								<a href="{{ path('view_ad',{'id': ad.ad.id}) }}" class="header">{{ ad.ad.title }}
									-
									{{ad.ad.price}}$</a>
								<div class="description">Uploaded
									{{ ad.ad.createdAt|date("m/d/Y") }}, viewed
									{{ ad.ad.viewCount}}
									times</div>
							</div>
							{% if ad.ad.createdBy ==  app.user or is_granted('ROLE_ADMIN') %}
								<a class="ui red left floated button" href="{{ path('remove_ad',{'id': ad.ad.id}) }}">Delete</a>
							{% endif %}
						</div>

					{% else %}

						{% if ad.boost is not null and ad.boost.dateFrom|date('Y-m-d') <= "now"|date('Y-m-d') %}
							<div class="item boosted">
							{% else %}
								<div class="item">
								{% endif %}
								<div class="ui content">
									<a href="{{ path('view_ad',{'id': ad.id}) }}" class="header">{{ ad.title }}
										-
										{{ad.price}}$</a>
									<div class="description">Uploaded
										{{ ad.createdAt|date("m/d/Y") }}, viewed
										{{ ad.viewCount}}
										times</div>
								</div>
								{% if ad.createdBy == app.user or is_granted('ROLE_ADMIN') %}
									<a class="ui red left floated button" href="{{ path('remove_ad',{'id': ad.id}) }}">Delete</a>
								{% endif %}
							</div>
						{% endif %}
					{% endfor %}
				</div>

				<div class="ui right floated pagination menu">
					{{ knp_pagination_render(pagination) }}
				</div>

			</div>
			<script>
				$('#category').dropdown();
			</script>

		{% endblock %}
